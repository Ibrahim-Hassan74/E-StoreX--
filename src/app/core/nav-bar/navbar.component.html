<nav class="w-full bg-white border-b border-gray-200 shadow-sm px-4">
  <div class="lg:container flex items-center justify-between h-[75px] px-4">
    <!-- Logo + Location -->
    <div class="flex items-center gap-6">
      <!-- Logo -->
      <a routerLink="/" class="text-2xl font-bold flex items-center gap-2">
        <lucide-icon
          name="armchair"
          size="28"
          class="text-[#029fae]"
        ></lucide-icon>
        E-StoreX
      </a>

      <!-- Location -->
      <div
        class="hidden md:flex gap-2 cursor-pointer text-gray-600 items-center hover:text-[#029fae] ml-4 relative"
        (click)="toggleLocation()"
      >
        <!-- Icon + Label -->
        <lucide-icon
          name="map-pin"
          size="20"
          class="w-5 h-5 text-[#029fae]"
        ></lucide-icon>
        <span class="font-medium">Add Address</span>
        <lucide-icon
          name="chevron-down"
          size="16"
          class="w-4 h-4 ml-1 transition-transform duration-200"
          [class.rotate-180]="isLocationOpen()"
        ></lucide-icon>

        <!-- Popup -->
        @if(isLocationOpen()) {
        <div
          class="absolute top-full left-0 translate-x-10 mt-2 w-[320px] z-50 shadow-xl bg-white border border-gray-200 rounded-2xl p-5"
          (click)="$event.stopPropagation()"
        >
          <!-- Header -->
          <div class="flex justify-between items-center border-b pb-3 mb-4">
            <h1 class="font-semibold text-lg text-gray-800">Change Location</h1>
            <div
              class="w-5 h-5 cursor-pointer text-gray-500 hover:text-red-500 transition"
              (click)="closeLocation()"
            >
              <lucide-icon name="x" size="20"></lucide-icon>
            </div>
          </div>

          <!-- Body -->
          <div class="flex flex-col gap-3">
            <button
              class="flex items-center justify-center gap-2 bg-[#029fae] text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-[#04b5c6] transition"
            >
              <lucide-icon
                name="crosshair"
                size="16"
                class="w-4 h-4"
              ></lucide-icon>
              Detect my location
            </button>
          </div>
        </div>
        }
      </div>
    </div>

    <!-- Links + Actions -->
    <div class="flex items-center gap-6">
      <!-- Links -->
      <div class="hidden md:flex items-center gap-6">
        <a
          routerLink="/"
          routerLinkActive="active-link"
          [routerLinkActiveOptions]="{ exact: true }"
          class="text-gray-600 hover:text-[#029fae]"
          >Home</a
        >
        <a
          routerLink="/shop"
          routerLinkActive="active-link"
          class="text-gray-600 hover:text-[#029fae]"
          >Shop</a
        >
        <a
          routerLink="/product"
          routerLinkActive="active-link"
          class="text-gray-600 hover:text-[#029fae]"
          >Product</a
        >
        <a
          routerLink="/about"
          routerLinkActive="active-link"
          class="text-gray-600 hover:text-[#029fae]"
          >About</a
        >
        <a
          routerLink="/contact"
          routerLinkActive="active-link"
          class="text-gray-600 hover:text-[#029fae]"
          >Contact</a
        >
      </div>

      <!-- Actions -->
      <div class="hidden md:flex items-center gap-4">
        <button class="btn relative">
          <lucide-icon name="shopping-cart" size="22"></lucide-icon>
          <span class="ml-1">Cart</span>
          <span
            class="badge absolute -top-2 -right-2 bg-[#029fae] text-white text-xs px-1.5 py-0.5 rounded-full"
            >2</span
          >
        </button>

        <button class="btn">
          <lucide-icon name="heart" size="22"></lucide-icon>
        </button>

        <!-- Dropdown -->
        <div
          class="relative"
          (mouseleave)="closeDropdown()"
          [style]="isDropdownOpen() ? 'padding-bottom: 0.5rem' : ''"
        >
          <button (click)="toggleDropdown($event)" class="btn">
            <lucide-icon name="user" size="22"></lucide-icon>
          </button>
          <ul
            [hidden]="!isDropdownOpen()"
            class="absolute right-0 w-48 bg-white shadow-md rounded p-2 z-10 mt-2"
          >
            <li>
              <a
                routerLink="/account"
                class="block px-4 py-2 hover:bg-gray-100 rounded"
                >Account</a
              >
            </li>
            <li>
              <a
                routerLink="/logout"
                class="block px-4 py-2 hover:bg-gray-100 rounded"
                >Logout</a
              >
            </li>
          </ul>
        </div>
      </div>

      <!-- Mobile menu button -->
      <button class="md:hidden" (click)="toggleMobileMenu()">
        <lucide-icon name="menu" size="24"></lucide-icon>
      </button>
    </div>
  </div>
</nav>
